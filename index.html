<!DOCTYPE html>
<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Screen Recorder Web App</title>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#137fec",
                        "primary-dark": "#1066be",
                        "background-light": "#f8fafc",
                        "background-dark": "#0f172a",
                        "surface-light": "#ffffff",
                        "surface-dark": "#1e293b",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"],
                        "body": ["Inter", "sans-serif"],
                    },
                    borderRadius: {
                        "DEFAULT": "0.375rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "2xl": "1rem",
                        "full": "9999px",
                    },
                },
            },
        }
    </script>
<style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .material-symbols-outlined {
            font-variation-settings:
            'FILL' 0,
            'wght' 400,
            'GRAD' 0,
            'opsz' 24
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 min-h-screen flex flex-col">
<header class="sticky top-0 z-50 w-full border-b border-slate-200 dark:border-slate-800 bg-surface-light/80 dark:bg-surface-dark/80 backdrop-blur-md">
<div class="flex h-16 items-center justify-between px-6 lg:px-10 max-w-7xl mx-auto w-full">
<div class="flex items-center gap-3">
<div class="flex items-center justify-center size-10 rounded-xl bg-primary/10 text-primary">
<span class="material-symbols-outlined text-2xl">videocam</span>
</div>
<h1 class="text-xl font-bold tracking-tight text-slate-900 dark:text-white">ScreenRecorder</h1>
</div>
<button class="flex items-center justify-center size-10 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors text-slate-600 dark:text-slate-300">
<span class="material-symbols-outlined">settings</span>
</button>
</div>
</header>
<main class="flex-grow flex flex-col items-center justify-start py-10 px-4 md:px-6 w-full max-w-7xl mx-auto gap-12">
<section class="w-full max-w-3xl flex flex-col items-center text-center gap-8 py-10 md:py-16">
<div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-sm font-medium">
<span class="relative flex h-2.5 w-2.5">
<span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
<span class="relative inline-flex rounded-full h-2.5 w-2.5 bg-green-500"></span>
</span>
            Ready to Record
        </div>
<div class="space-y-4 max-w-xl">
<h1 class="text-4xl md:text-6xl font-black tracking-tight text-slate-900 dark:text-white leading-[1.1]">
                Capture your screen <span class="text-primary">instantly</span>
</h1>
<p class="text-lg text-slate-500 dark:text-slate-400">
                No installation required. High quality export. <br/> 
                Select your window and start sharing.
            </p>
</div>
<div class="flex flex-col sm:flex-row items-center justify-center gap-4 w-full">
    <button id="start-record-btn" class="group relative flex items-center justify-center gap-3 h-16 px-10 rounded-xl bg-red-600 hover:bg-red-700 text-white font-bold text-lg shadow-lg shadow-red-600/30 hover:shadow-xl hover:shadow-red-600/40 transition-all transform hover:-translate-y-0.5 active:translate-y-0 active:scale-95 w-full sm:w-auto">
        <span class="material-symbols-outlined text-3xl">radio_button_checked</span>
        Start Recording
    </button>
    <button id="export-video-btn" class="group relative flex items-center justify-center gap-3 h-16 px-10 rounded-xl bg-indigo-600 hover:bg-indigo-700 text-white font-bold text-lg shadow-lg shadow-indigo-600/30 hover:shadow-xl hover:shadow-indigo-600/40 transition-all transform hover:-translate-y-0.5 active:translate-y-0 active:scale-95 w-full sm:w-auto">
        <span class="material-symbols-outlined text-3xl">download</span>
        Export Video
    </button>
</div>
<div class="flex flex-wrap justify-center gap-6 mt-4 text-slate-400 dark:text-slate-500 text-sm font-medium">
<div class="flex items-center gap-1.5">
<span class="material-symbols-outlined text-lg">hd</span>
                1080p Export
            </div>
<div class="flex items-center gap-1.5">
<span class="material-symbols-outlined text-lg">mic</span>
                Audio Capture
            </div>
<div class="flex items-center gap-1.5">
<span class="material-symbols-outlined text-lg">timer_off</span>
                Unlimited Time
            </div>
</div>
</section>
</main>
<footer class="w-full bg-surface-light dark:bg-surface-dark border-t border-slate-200 dark:border-slate-800 py-8">
<div class="max-w-7xl mx-auto px-6 flex flex-col md:flex-row items-center justify-between gap-6">
<div class="flex items-center gap-2 text-slate-500 dark:text-slate-400 text-sm">
<span>© 2026 ScreenRecorder App. All rights reserved.</span>
</div>
<!-- <div class="flex items-center gap-6">
<a class="text-sm font-medium text-slate-500 dark:text-slate-400 hover:text-primary dark:hover:text-primary transition-colors" href="#">Privacy Policy</a>
<a class="text-sm font-medium text-slate-500 dark:text-slate-400 hover:text-primary dark:hover:text-primary transition-colors" href="#">Terms of Service</a>
<a class="text-sm font-medium text-slate-500 dark:text-slate-400 hover:text-primary dark:hover:text-primary transition-colors" href="#">Help Center</a>
</div> -->
</div>
</footer>
<script>
let mediaRecorder = null;
let recordedChunks = [];
let recordingStartTime = null;
let recordingTimer = null;
let videoBlob = null;

// 直接通过ID获取按钮
const startBtn = document.getElementById('start-record-btn');
const exportBtn = document.getElementById('export-video-btn');
const statusDiv = document.querySelector('section > div.inline-flex');
const btnIcon = startBtn.querySelector('.material-symbols-outlined');
let durationSpan = null;

// 辅助函数：格式化时长
function formatDuration(ms) {
    const sec = Math.floor(ms / 1000) % 60;
    const min = Math.floor(ms / 60000);
    return `${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
}

// 更新录制时长
function updateDuration() {
    if (!durationSpan || !recordingStartTime) return;
    const elapsed = Date.now() - recordingStartTime;
    durationSpan.textContent = formatDuration(elapsed);
}

// 切换按钮和状态
function setRecordingUI(isRecording) {
    if (isRecording) {
        btnIcon.textContent = 'stop_circle';
        startBtn.classList.remove('bg-red-600', 'hover:bg-red-700');
        startBtn.classList.add('bg-gray-600', 'hover:bg-gray-700');
        startBtn.childNodes[2].nodeValue = ' 停止录制';
        statusDiv.classList.remove('bg-green-100', 'dark:bg-green-900/30', 'text-green-700', 'dark:text-green-400');
        statusDiv.classList.add('bg-red-100', 'dark:bg-red-900/30', 'text-red-700', 'dark:text-red-400');
        statusDiv.innerHTML = `
            <span class="relative flex h-2.5 w-2.5">
                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
                <span class="relative inline-flex rounded-full h-2.5 w-2.5 bg-red-500"></span>
            </span>
            正在录制
            <span id="rec-duration" class="ml-2 font-mono text-xs px-2 py-0.5 rounded bg-red-200 dark:bg-red-800/40 text-red-900 dark:text-red-100"></span>
        `;
        durationSpan = statusDiv.querySelector('#rec-duration');
        durationSpan.textContent = '00:00';
        recordingTimer = setInterval(updateDuration, 500);
    } else {
        btnIcon.textContent = 'radio_button_checked';
        startBtn.classList.remove('bg-gray-600', 'hover:bg-gray-700');
        startBtn.classList.add('bg-red-600', 'hover:bg-red-700');
        startBtn.childNodes[2].nodeValue = ' Start Recording';
        statusDiv.classList.remove('bg-red-100', 'dark:bg-red-900/30', 'text-red-700', 'dark:text-red-400');
        statusDiv.classList.add('bg-green-100', 'dark:bg-green-900/30', 'text-green-700', 'dark:text-green-400');
        statusDiv.innerHTML = `
            <span class="relative flex h-2.5 w-2.5">
                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                <span class="relative inline-flex rounded-full h-2.5 w-2.5 bg-green-500"></span>
            </span>
            Ready to Record
        `;
        if (recordingTimer) clearInterval(recordingTimer);
        durationSpan = null;
    }
}

// 合并屏幕和麦克风音频
async function startRecording() {
    try {
        const screenStream = await navigator.mediaDevices.getDisplayMedia({
            video: { frameRate: 30 },
            audio: true // 尝试获取系统音频
        });
        const micStream = await navigator.mediaDevices.getUserMedia({ audio: true });
        // 合并音轨
        const tracks = [
            ...screenStream.getVideoTracks(),
            ...screenStream.getAudioTracks(),
            ...micStream.getAudioTracks()
        ];
        const mixedStream = new MediaStream(tracks);
        recordedChunks = [];
        mediaRecorder = new MediaRecorder(mixedStream, { mimeType: 'video/webm; codecs=vp9' });
        mediaRecorder.ondataavailable = e => {
            if (e.data.size > 0) recordedChunks.push(e.data);
        };
        mediaRecorder.onstop = () => {
            videoBlob = new Blob(recordedChunks, { type: 'video/webm' });
            exportBtn.disabled = false;
        };
        mediaRecorder.start();
        recordingStartTime = Date.now();
        setRecordingUI(true);
        exportBtn.disabled = true;
        screenStream.getVideoTracks()[0].addEventListener('ended', () => {
            if (mediaRecorder && mediaRecorder.state === 'recording') stopRecording();
        });
    } catch (err) {
        alert('无法获取录制权限');
    }
}

// 停止录制
function stopRecording() {
    if (mediaRecorder && mediaRecorder.state === 'recording') {
        mediaRecorder.stop();
        setRecordingUI(false);
    }
}

// 导出为 webm
async function exportVideo() {
    if (!videoBlob) {
        alert('没有可导出的视频，请先录制');
        return;
    }
    const url = URL.createObjectURL(videoBlob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'screen-recording.webm';
    document.body.appendChild(a);
    a.click();
    setTimeout(() => {
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }, 100);
}

// 按钮事件绑定
startBtn.addEventListener('click', () => {
    if (mediaRecorder && mediaRecorder.state === 'recording') {
        stopRecording();
    } else {
        startRecording();
    }
});
exportBtn.addEventListener('click', exportVideo);
exportBtn.disabled = true;
</script>
</body></html>